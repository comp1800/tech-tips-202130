<!DOCTYPE html>
<html>
​

<head>
    <meta charset="utf-8">
    <title>Wellness @ BCIT</title>
    <meta page="comp1800 boilerplate code" content="my bcit project">
    <meta name="author" content="BBY26">
    ​
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    ​
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <!-- <link href="styles/directory.css" rel="stylesheet"> -->
    <!-- <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=menu">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"> -->
    ​
    <!-- Firebase 8 CDNs-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    ​
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-storage.js"></script>
    <!-- Link to the api keys for your firebase project -->
    <script src="./scripts/firebaseAPI_TEAM99.js"></script>
    ​
</head>
​

<body>

    <div class="container">
        <div class="container text-center py-3">
            <img id="mypic-goes-here" >
            <input type="file" id="upload" accept="image/*" />
        </div>
    </div>

    <script>
        function uploadUserProfilePic2() {
            // Let's assume my storage is only enabled for authenticated users 
            // This is set in your firebase console storage "rules" tab

            // firebase.auth().onAuthStateChanged(function (user) {
            var fileInput = document.getElementById("upload"); // pointer #1
            const image = document.getElementById("mypic-goes-here"); // pointer #2

            // listen for file selection
            fileInput.addEventListener('change', function (e) {
                var file = e.target.files[0];
                var blob = URL.createObjectURL(file);
                image.src = blob; // display this image

                var metadata = {
                    contentType: 'image/jpeg',
                };

                //store using this name
                var storageRef = storage.ref("blah.jpg");
                //alert(file);
                //upload the picked file
                storageRef.put(file, metadata)
                    .then(function () {
                        console.log('Uploaded to Cloud Storage.');
                        // storageRef.getDownloadURL()
                        //     .then(function (url) { // Get URL of the uploaded file
                        //         console.log(url); // Save the URL into users collection
                        //         db.collection("users").doc(user.uid).update({
                        //                 "profilePic": url
                        //             })
                        //             .then(function () {
                        //                 console.log(
                        //                     'Added Profile Pic URL to Firestore.');
                        //             })
                        //     })
                    })

                //get the URL of stored file

            })
            //})
        }
        uploadUserProfilePic2();
    </script>
</body>

</html>